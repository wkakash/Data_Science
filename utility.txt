functions for version 5