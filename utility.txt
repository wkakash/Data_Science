functions for version 4